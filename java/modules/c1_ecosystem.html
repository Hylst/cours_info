<section id="c1">
    <div class="container">
        <div class="sec-header">
            <div class="sec-num">01</div>
            <div>
                <h2 class="sec-title">L'√âcosyst√®me Java</h2>
                <p class="sec-sub">JVM, JDK, JRE & Bytecode</p>
            </div>
        </div>

        <!-- Introduction Contextuelle -->
        <div class="callout callout-info">
            <h4>üéì Avant de Commencer</h4>
            <p><strong>Pr√©requis</strong> : Aucun ! C'est le point de d√©part.</p>
            <p><strong>Ce que vous allez apprendre</strong> : Comprendre pourquoi Java est "portable" et comment
                fonctionne sa compilation en 2 √©tapes.</p>
            <p><strong>Temps de lecture</strong> : ~8 minutes | <strong>Niveau</strong> : ‚≠ê‚òÜ‚òÜ</p>
        </div>

        <h3 style="margin-top: 2rem; margin-bottom: 1rem;">üìú Contexte Historique : Le Probl√®me de la Portabilit√©</h3>
        <p>Dans les ann√©es 1990, d√©velopper un logiciel √©tait un cauchemar. Si vous √©criviez un programme en C++ pour
            Windows, il ne fonctionnait pas sur Mac ou Linux sans r√©√©crire une grande partie du code. Chaque syst√®me
            d'exploitation (OS) parlait un "dialecte" diff√©rent.</p>

        <p style="margin-top: 1rem;"><strong>Sun Microsystems</strong> (rachet√© par Oracle en 2010) a cr√©√© Java en 1995
            avec une promesse r√©volutionnaire : <strong>"Write Once, Run Anywhere"</strong> (WORA). L'id√©e ? Introduire
            un interm√©diaire universel entre votre code et la machine : la <strong>JVM</strong>.</p>

        <div class="callout callout-recall" style="margin-top: 1.5rem;">
            <h4>üìå Rappel Cl√©</h4>
            <p>Java ne compile PAS directement en code machine (comme C/C++). Il compile en <strong>Bytecode</strong>,
                un langage interm√©diaire que la JVM traduit ensuite pour chaque OS.</p>
        </div>

        <!-- Analogy -->
        <div class="analogy">
            <p>Le Restaurant Universel</p>
            <ul style="text-align: left; margin-top: 1rem; list-style: none; padding-left: 0;">
                <li style="margin-bottom: 0.5rem;">üë®‚Äçüç≥ <strong>Le Chef (D√©veloppeur)</strong> : √âcrit la recette en
                    fran√ßais (Code Java).</li>
                <li style="margin-bottom: 0.5rem;">üìú <strong>La Recette (Code Source .java)</strong> : Lisible par le
                    chef, mais on ne mange pas du papier.</li>
                <li style="margin-bottom: 0.5rem;">üç≥ <strong>La Cuisine (JDK)</strong> : Contient les outils
                    (Compilateur <code>javac</code>) pour transformer la recette en plat standardis√©.</li>
                <li style="margin-bottom: 0.5rem;">üì¶ <strong>Le Plat Pr√©par√© (Bytecode .class)</strong> : Format
                    universel, comme un plat sous vide. Peu importe o√π vous l'ouvrez, c'est le m√™me plat.</li>
                <li>üçΩÔ∏è <strong>Le Serveur (JVM)</strong> : Re√ßoit le plat et le sert au client (Windows, Mac, Linux) en
                    l'adaptant √† ses couverts sp√©cifiques (architecture CPU).</li>
            </ul>
        </div>

        <!-- Diagram -->
        <div class="diagram-container">
            <div class="mermaid">
                flowchart LR
                A[Source .java] -->|javac| B(Bytecode .class)
                B -->|Classloader| C{JVM}
                C -->|Interpreter / JIT| D[Machine Code]
                C -->|OS| E[Windows/Linux/Mac]
                style A fill:#ffa94d,stroke:#3d444d,stroke-width:2px,color:#0d1117
                style B fill:#79c0ff,stroke:#3d444d,stroke-width:2px,color:#f0f6fc
                style C fill:#3fb950,stroke:#3d444d,stroke-width:2px,color:#f0f6fc
            </div>
            <p style="margin-top:10px; font-size:0.9rem; color: var(--text-muted-foreground);">Le flux "Write Once, Run
                Anywhere"</p>
        </div>

        <!-- Les 3 Acronymes -->
        <h3 style="margin-top: 2.5rem; margin-bottom: 1rem;">üîë Les 3 Piliers de l'√âcosyst√®me</h3>

        <details open>
            <summary>üìñ JDK, JRE, JVM : Qui fait quoi ?</summary>
            <div class="grid2">
                <div class="callout callout-warning" style="margin:0">
                    <h4>üõ†Ô∏è JDK (Java Development Kit)</h4>
                    <p><strong>Pour D√âVELOPPER</strong>. C'est la bo√Æte √† outils compl√®te du d√©veloppeur.</p>
                    <p style="margin-top: 0.5rem;"><strong>Contient</strong> :</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Le compilateur <code>javac</code></li>
                        <li>Le JRE (pour tester)</li>
                        <li>Outils de debug (<code>jdb</code>)</li>
                        <li>Outils de profiling (<code>jvisualvm</code>)</li>
                    </ul>
                </div>
                <div class="callout callout-info" style="margin:0">
                    <h4>‚ñ∂Ô∏è JRE (Java Runtime Environment)</h4>
                    <p><strong>Pour EX√âCUTER</strong>. C'est le minimum pour faire tourner une application Java.</p>
                    <p style="margin-top: 0.5rem;"><strong>Contient</strong> :</p>
                    <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                        <li>La JVM</li>
                        <li>Biblioth√®ques de base (<code>java.lang</code>, <code>java.util</code>...)</li>
                        <li>Fichiers de configuration</li>
                    </ul>
                </div>
            </div>
            <div class="callout callout-tip" style="margin-top:20px;">
                <h4>‚öôÔ∏è JVM (Java Virtual Machine)</h4>
                <p>Le <strong>MOTEUR</strong>. C'est une machine abstraite qui ex√©cute le bytecode. Elle traduit le
                    bytecode en instructions natives pour votre CPU (x86, ARM...).</p>
                <p style="margin-top: 0.5rem;"><strong>R√¥le cl√©</strong> : Assurer la portabilit√©. Une JVM existe pour
                    chaque OS (Windows JVM, Linux JVM, macOS JVM...).</p>
            </div>
        </details>

        <!-- Le Saviez-vous -->
        <div class="callout callout-recall" style="margin-top: 2rem;">
            <h4>üí° Le Saviez-vous ?</h4>
            <p><strong>Le Bytecode n'est pas du code machine</strong> : C'est un langage interm√©diaire, comme un
                "esperanto" pour ordinateurs. Il ressemble √† de l'assembleur mais reste ind√©pendant du processeur.</p>
            <p style="margin-top: 0.75rem;"><strong>Le JIT Compiler</strong> : La JVM ne se contente pas d'interpr√©ter
                le bytecode ligne par ligne (lent). Elle utilise un compilateur <strong>Just-In-Time (JIT)</strong> qui
                traduit les parties "chaudes" (souvent ex√©cut√©es) en code machine natif pour booster les performances.
            </p>
            <p style="margin-top: 0.75rem;"><strong>GraalVM</strong> : Une JVM moderne qui peut compiler Java en binaire
                natif (comme C++) pour des performances extr√™mes, au prix de la portabilit√©.</p>
        </div>

        <!-- Exemples Progressifs -->
        <h3 style="margin-top: 2.5rem; margin-bottom: 1rem;">üìù Exemples Progressifs</h3>

        <div class="grid2">
            <div class="code">
                <div class="code-head"><span class="dot r"></span>1. Hello World (Basique)</div>
                <pre><span class="kw">public class</span> <span class="type">Main</span> {
    <span class="kw">public static void</span> <span class="mt">main</span>(<span class="type">String</span>[] <span class="var">args</span>) {
        <span class="type">System</span>.out.println(<span class="str">"Hello Java!"</span>);
    }
}</pre>
            </div>
            <div class="code">
                <div class="code-head"><span class="dot g"></span>Terminal</div>
                <pre><span class="com"># 1. Compilation ‚Üí Main.class</span>
javac Main.java

<span class="com"># 2. Ex√©cution (JVM)</span>
java Main
<span class="str">"Hello Java!"</span></pre>
            </div>
        </div>

        <div class="code" style="margin-top: 1.5rem;">
            <div class="code-head"><span class="dot b"></span>2. V√©rifier votre Version Java</div>
            <pre><span class="com"># Version du JDK (compilateur)</span>
javac -version
<span class="str">javac 21.0.1</span>

<span class="com"># Version de la JVM (runtime)</span>
java -version
<span class="str">openjdk version "21.0.1" 2023-10-17 LTS
OpenJDK Runtime Environment (build 21.0.1+12-LTS)
OpenJDK 64-Bit Server VM (build 21.0.1+12-LTS, mixed mode)</span></pre>
        </div>

        <div class="code" style="margin-top: 1.5rem;">
            <div class="code-head"><span class="dot r"></span>3. Inspecter le Bytecode (Avanc√©)</div>
            <pre><span class="com"># D√©sassembler un fichier .class</span>
javap -c Main.class

<span class="com"># Sortie (extrait) :</span>
<span class="str">public static void main(java.lang.String[]);
  Code:
     0: getstatic     #7  // Field java/lang/System.out
     3: ldc           #13 // String Hello Java!
     5: invokevirtual #15 // Method println
     8: return</span></pre>
        </div>

        <!-- Cas d'Usage R√©el -->
        <div class="use-case" style="margin-top: 2.5rem;">
            <h4>üöÄ Cas d'Usage R√©el : Pourquoi Java Domine le Backend ?</h4>
            <p><strong>Sc√©nario</strong> : Vous d√©veloppez une API REST pour une banque. Votre code doit tourner sur des
                serveurs Linux (production), mais vous d√©veloppez sur Windows.</p>
            <p style="margin-top: 0.75rem;"><strong>Solution Java</strong> :</p>
            <ol style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li>Vous √©crivez le code sur Windows avec IntelliJ IDEA.</li>
                <li>Vous compilez en <code>.jar</code> (archive de fichiers <code>.class</code>).</li>
                <li>Vous d√©ployez le <code>.jar</code> sur un serveur Linux. La JVM Linux l'ex√©cute sans modification.
                </li>
            </ol>
            <p style="margin-top: 0.75rem;"><strong>Avantage</strong> : Pas de recompilation. Pas de surprise. Le m√™me
                bytecode fonctionne partout o√π il y a une JVM.</p>
        </div>

        <!-- Pi√®ges Courants -->
        <div class="callout callout-warning" style="margin-top: 2rem;">
            <h4>‚ö†Ô∏è Pi√®ges Courants</h4>
            <p><strong>1. Confondre JDK et JRE</strong> : Si vous voulez juste ex√©cuter une application (ex: Minecraft),
                le JRE suffit. Pour d√©velopper, il faut le JDK.</p>
            <p style="margin-top: 0.75rem;"><strong>2. Version Mismatch</strong> : Si vous compilez avec Java 17 mais
                ex√©cutez avec Java 8, √ßa crashe. Le bytecode a des versions (comme les formats de fichiers).</p>
            <p style="margin-top: 0.75rem;"><strong>3. Oublier le CLASSPATH</strong> : La JVM doit savoir o√π trouver vos
                fichiers <code>.class</code>. Par d√©faut, elle cherche dans le dossier courant.</p>
        </div>

        <!-- Pour Aller Plus Loin -->
        <div class="callout callout-tip" style="margin-top: 2rem;">
            <h4>üöÄ Pour Aller Plus Loin</h4>
            <p><strong>Ressources</strong> :</p>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li><a href="https://docs.oracle.com/javase/specs/jvms/se21/html/" target="_blank"
                        style="color: var(--text-accent);">Sp√©cification JVM (Oracle)</a></li>
                <li><strong>Livre</strong> : "Inside the Java Virtual Machine" de Bill Venners</li>
                <li><strong>Concept avanc√©</strong> : Garbage Collection (GC) - Comment la JVM g√®re automatiquement la
                    m√©moire</li>
            </ul>
        </div>

    </div>
</section>