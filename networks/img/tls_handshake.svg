<svg width="600" height="400" viewBox="0 0 600 400" fill="none" xmlns="http://www.w3.org/2000/svg">
    <style>
        .text { font-family: 'Segoe UI', sans-serif; fill: white; font-size: 14px; }
        .label { fill: #aaa; font-size: 12px; }
        .actor { stroke: #4fd1c5; stroke-width: 2; fill: none; }
        .arrow { stroke: #666; stroke-width: 2; marker-end: url(#arrow); }
        .arrow-enc { stroke: #ab47bc; stroke-width: 3; stroke-dasharray: 5 5; }
        .msg-box { fill: #2d3748; rx: 4; }
    </style>
    <defs>
        <marker id="arrow" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
        </marker>
    </defs>

    <!-- Background -->
    <rect width="600" height="400" fill="#1e1e1e" rx="10"/>

    <!-- Actors -->
    <text x="100" y="40" class="text" text-anchor="middle" style="font-weight:bold; font-size:16px;">CLIENT</text>
    <line x1="100" y1="60" x2="100" y2="380" stroke="#444" stroke-width="2" stroke-dasharray="5 5"/>

    <text x="500" y="40" class="text" text-anchor="middle" style="font-weight:bold; font-size:16px;">SERVEUR</text>
    <line x1="500" y1="60" x2="500" y2="380" stroke="#444" stroke-width="2" stroke-dasharray="5 5"/>

    <!-- Step 1: Client Hello -->
    <line x1="100" y1="90" x2="490" y2="90" class="arrow"/>
    <rect x="230" y="75" width="140" height="30" class="msg-box"/>
    <text x="300" y="95" class="text" text-anchor="middle">1. ClientHello</text>
    <text x="300" y="120" class="label" text-anchor="middle">(Version TLS, Suites Crypto)</text>

    <!-- Step 2: Server Hello -->
    <line x1="500" y1="160" x2="110" y2="160" class="arrow"/>
    <rect x="210" y="145" width="180" height="30" class="msg-box"/>
    <text x="300" y="165" class="text" text-anchor="middle">2. ServerHello + Cert</text>
    <text x="300" y="190" class="label" text-anchor="middle">(Choix Crypto, Clé Publique)</text>

    <!-- Step 3: Key Exchange -->
    <line x1="100" y1="240" x2="490" y2="240" class="arrow"/>
    <rect x="220" y="225" width="160" height="30" class="msg-box" style="stroke:#4fd1c5; stroke-width:1"/>
    <text x="300" y="245" class="text" text-anchor="middle">3. Clé Pré-Master</text>
    <text x="300" y="270" class="label" text-anchor="middle">(Chiffrée avec Clé Publique)</text>

    <!-- Step 4: Encrypted Tunnel -->
    <rect x="100" y="310" width="400" height="50" fill="#ab47bc" fill-opacity="0.1" rx="10"/>
    <line x1="120" y1="335" x2="480" y2="335" class="arrow-enc"/>
    <text x="300" y="330" class="text" text-anchor="middle" fill="#ab47bc" style="font-weight:bold">TUNNEL CHIFFRÉ (AES)</text>
    <text x="300" y="350" class="label" text-anchor="middle">Session Keys générées</text>

</svg>
