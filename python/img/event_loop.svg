<svg width="750" height="400" viewBox="0 0 750 400" fill="none" xmlns="http://www.w3.org/2000/svg">
    <style>
        .text { font-family: 'Segoe UI', sans-serif; fill: #e2e8f0; font-size: 12px; }
        .label { font-family: 'Segoe UI', sans-serif; font-weight: bold; font-size: 14px; text-anchor: middle; }
        .code { font-family: 'Consolas', monospace; font-size: 11px; fill: #ffd43b; }
        .box { stroke-width: 2; rx: 5; }
        .arrow { stroke: #718096; stroke-width: 2; marker-end: url(#arrowhead); }
        
        @keyframes rotate { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        
        .spin { animation: rotate 4s linear infinite; transform-origin: 375px 200px; }
        .task1 { animation: pulse 2s ease-in-out infinite; animation-delay: 0s; }
        .task2 { animation: pulse 2s ease-in-out infinite; animation-delay: 0.5s; }
        .task3 { animation: pulse 2s ease-in-out infinite; animation-delay: 1s; }
    </style>
    <defs>
        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
            <polygon points="0 0, 10 3.5, 0 7" fill="#718096" />
        </marker>
    </defs>

    <rect width="750" height="400" fill="#1a202c" rx="10"/>
    <text x="375" y="30" class="label" fill="#3776ab" text-anchor="middle" font-size="16">Event Loop - async/await en Python</text>

    <!-- Event Loop Circle -->
    <g class="spin">
        <circle cx="375" cy="200" r="100" fill="none" stroke="#4a5568" stroke-width="4" stroke-dasharray="10 5"/>
    </g>
    <circle cx="375" cy="200" r="80" fill="#2d3748" stroke="#3776ab" stroke-width="3"/>
    <text x="375" y="195" class="label" fill="#3776ab" text-anchor="middle">Event</text>
    <text x="375" y="215" class="label" fill="#3776ab" text-anchor="middle">Loop</text>

    <!-- Tasks Queue -->
    <g transform="translate(50, 100)">
        <text x="60" y="0" class="label" fill="#ffd43b">TÃ¢ches (Coroutines)</text>
        
        <rect x="0" y="20" width="120" height="40" class="box task1" fill="#27ae60" stroke="#1e8449"/>
        <text x="60" y="45" class="text" text-anchor="middle">fetch_data()</text>
        
        <rect x="0" y="70" width="120" height="40" class="box task2" fill="#e67e22" stroke="#d35400"/>
        <text x="60" y="95" class="text" text-anchor="middle">process_api()</text>
        
        <rect x="0" y="120" width="120" height="40" class="box task3" fill="#9b59b6" stroke="#8e44ad"/>
        <text x="60" y="145" class="text" text-anchor="middle">save_db()</text>
    </g>

    <!-- Arrow from Tasks to Loop -->
    <path d="M 175 170 L 280 180" class="arrow"/>
    <text x="220" y="160" class="text" fill="#888">await</text>

    <!-- Waiting I/O -->
    <g transform="translate(530, 100)">
        <text x="80" y="0" class="label" fill="#e74c3c">En attente I/O</text>
        
        <rect x="0" y="20" width="140" height="35" class="box" fill="#2d3748" stroke="#e74c3c" opacity="0.6"/>
        <text x="70" y="42" class="text" text-anchor="middle" fill="#e74c3c">ğŸŒ HTTP Request</text>
        
        <rect x="0" y="65" width="140" height="35" class="box" fill="#2d3748" stroke="#e74c3c" opacity="0.6"/>
        <text x="70" y="87" class="text" text-anchor="middle" fill="#e74c3c">ğŸ’¾ File Read</text>
        
        <rect x="0" y="110" width="140" height="35" class="box" fill="#2d3748" stroke="#e74c3c" opacity="0.6"/>
        <text x="70" y="132" class="text" text-anchor="middle" fill="#e74c3c">ğŸ—„ï¸ DB Query</text>
    </g>

    <!-- Arrow from Loop to Waiting -->
    <path d="M 470 180 L 525 155" class="arrow"/>
    <text x="510" y="150" class="text" fill="#888">suspend</text>

    <!-- Ready Queue -->
    <g transform="translate(530, 250)">
        <text x="80" y="0" class="label" fill="#27ae60">PrÃªtes (I/O terminÃ©)</text>
        <rect x="0" y="15" width="140" height="35" class="box" fill="#27ae60" stroke="#1e8449"/>
        <text x="70" y="38" class="text" text-anchor="middle">âœ“ Response ready</text>
    </g>

    <!-- Arrow from Ready to Loop -->
    <path d="M 525 275 L 470 230" class="arrow"/>
    <text x="485" y="265" class="text" fill="#888">resume</text>

    <!-- Explanation -->
    <g transform="translate(50, 320)">
        <rect width="650" height="60" fill="#2d3748" rx="5"/>
        <text x="325" y="20" class="text" text-anchor="middle" font-weight="bold" fill="#ffd43b">ğŸ”„ Fonctionnement</text>
        <text x="325" y="40" class="text" text-anchor="middle">1. await suspend la coroutine â†’ 2. Loop exÃ©cute une autre tÃ¢che â†’ 3. I/O terminÃ© â†’ 4. Resume la coroutine</text>
        <text x="325" y="55" class="text" text-anchor="middle" font-size="11" fill="#888">RÃ©sultat : Pas de blocage, exÃ©cution concurrente (mais pas parallÃ¨le) sur un seul thread</text>
    </g>
</svg>
