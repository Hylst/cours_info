<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M√©mo Python Data Science - Guide 2025</title>
    <meta name="description"
        content="Guide complet Python pour la Data Science : Numpy, Pandas, Matplotlib, Scikit-Learn.">
    <meta name="keywords"
        content="Python, Data Science, Numpy, Pandas, Matplotlib, Scikit-Learn, Machine Learning, IA, Analyse de donn√©es">
    <meta name="author" content="Geoffroy Streit">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#3b82f6">
    <link rel="canonical" href="index.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="M√©mo Python Data Science">
    <meta property="og:description"
        content="Guide complet Python pour la Data Science : Numpy, Pandas, Matplotlib, Scikit-Learn.">
    <meta property="og:url" content="https://hylst.fr/cours/docker/python_data/index.html">
    <meta property="og:locale" content="fr_FR">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="M√©mo Python Data Science">
    <meta name="twitter:description"
        content="Guide complet Python pour la Data Science : Numpy, Pandas, Matplotlib, Scikit-Learn.">
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/quiz-style.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <header>
        <div class="container header-content">
            <div class="logo">
                <div class="logo-icon">üìä</div>Python Data
            </div>
            <nav>
                <a href="#s0">Intro</a>
                <a href="#s2">Acquisition</a>
                <a href="#s3">Pandas</a>
                <a href="#s5">ML</a>
                <a href="#s7">Prod</a>
            </nav>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <h1>Python Data Science</h1>
            <p>Le m√©mo de l'essentiel pour manipuler, analyser et visualiser les donn√©es.
                <br><em>Votre antis√®che pour les projets et entretiens techniques.</em>
            </p>
        </div>
    </section>

    <!-- INTRO GENERAL -->
    <div class="intro-box"
        style="background:var(--card-bg); border-bottom:1px solid var(--border-color); padding:30px 0;">
        <div class="container">
            <h3 style="margin-top:0; color:var(--text-color)">Pourquoi Python pour la Data ?</h3>
            <p style="color:#c9d1d9; max-width:800px;">
                Python s'est impos√© comme le standard absolu de la Data Science, √©crasant R et Matlab.
                Sa force r√©side dans son √©cosyst√®me unifi√© : une seule langue pour l'exploration (Pandas),
                la visualisation (Matplotlib), le Machine Learning (Sklearn) et la mise en production (FastAPI).
            </p>
            <p style="color:#8b949e; font-size:0.95rem; margin-top:10px;">
                C'est le couteau suisse ultime : vous pouvez extraire vos donn√©es d'une API, entrainer une IA complexe,
                et la d√©ployer sur un serveur web, le tout sans changer de langage.
            </p>
        </div>
    </div>

    <div class="toc">
        <div class="container">
            <div class="toc-grid">
                <a href="#s0" class="toc-item"><span class="toc-num">00</span>√âcosyst√®me Data</a>
                <a href="#s1" class="toc-item"><span class="toc-num">01</span>Numpy (Calculs)</a>
                <a href="#s2" class="toc-item"><span class="toc-num">02</span>Acquisition (SQL/API)</a>
                <a href="#s3" class="toc-item"><span class="toc-num">03</span>Pandas (Expert)</a>
                <a href="#s4" class="toc-item"><span class="toc-num">04</span>Visualisation Pro</a>
                <a href="#s5" class="toc-item"><span class="toc-num">05</span>Machine Learning</a>
                <a href="#s6" class="toc-item"><span class="toc-num">06</span>Deep Learning</a>
                <a href="#s7" class="toc-item"><span class="toc-num">07</span>Mise en Production</a>
                <a href="#s8" class="toc-item"><span class="toc-num">08</span>R√©f√©rence</a>
            </div>
        </div>
    </div>

    <!-- S0: INTRO -->
    <section id="s0">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">00</div>
                <div>
                    <h2 class="sec-title">L'√âcosyst√®me Data</h2>
                    <p class="sec-sub">Jupyter, Anaconda, Colab</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre l'environnement Data</summary>
                <div>
                    <p>En Data Science, on n'√©crit pas le code comme pour le Web. On explore les donn√©es de mani√®re
                        interactive.</p>
                    <p>L'outil roi est le <strong>Notebook Jupyter</strong> (fichier `.ipynb`). Il alterne cellules de
                        code (ex√©cutables ind√©pendamment) et cellules de texte (Markdown).</p>
                    <p>La distribution <strong>Anaconda</strong> est recommand√©e car elle pr√©-installe toutes les
                        librairies scientifiques complexes (qui n√©cessitent parfois de la compilation C/C++).</p>
                </div>
            </details>

            <div class="grid3" style="margin-top:20px;">
                <div class="tool-card">
                    <span class="tool-icon">ü™ê</span>
                    <h3>Jupyter Lab</h3>
                    <p>L'IDE interactif standard. Parfait pour l'exploration et la visualisation.</p>
                </div>
                <div class="tool-card">
                    <span class="tool-icon">üêç</span>
                    <h3>Anaconda</h3>
                    <p>Gestionnaire d'environnement robuste. Isole vos projets Data.</p>
                </div>
                <div class="tool-card">
                    <span class="tool-icon">‚òÅÔ∏è</span>
                    <h3>Google Colab</h3>
                    <p>Jupyter h√©berg√© dans le cloud avec acc√®s GPU gratuit. Id√©al pour partager.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- S1: NUMPY -->
    <section id="s1">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">01</div>
                <div>
                    <h2 class="sec-title">Numpy : Le Socle</h2>
                    <p class="sec-sub">Tableaux multidimensionnels & Calcul matriciel</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre Numpy (Avanc√©)</summary>
                <div>
                    <p>Les listes Python sont trop lentes pour des millions de calculs. Numpy introduit les
                        <strong>Arrays</strong> (tableaux) typ√©s.
                    </p>
                    <p>Le <strong>Reshaping</strong> est critique pour le Deep Learning (ex: transformer une image 28x28
                        en vecteur 784).</p>
                    <p>Le <strong>Broadcasting</strong> permet des op√©rations matrice-vecteur ultra-rapides sans
                        boucles.</p>
                </div>
            </details>

            <div class="grid2">
                <div class="code">
                    <div class="code-head"><span class="dot g"></span>Indexing, Types & Performance</div>
                    <pre><span class="kw">import</span> numpy <span class="kw">as</span> np

<span class="c"># 1. Optimisation M√©moire (Critical Big Data)</span>
<span class="c"># int8 : -128 √† 127 (1 octet) vs int64 (8 octets)</span>
<span class="var">arr_opt</span> = <span class="var">np</span>.<span class="fn">array</span>([<span class="num">1</span>, <span class="num">2</span>, <span class="num">100</span>], dtype=<span class="str">'int8'</span>)

<span class="c"># 2. Performance (Vectorisation vs Boucle)</span>
<span class="c"># %timeit [i**2 for i in range(1000000)]  -> 300ms</span>
<span class="c"># %timeit np.arange(1000000)**2           -> 3ms (x100 !)</span>

<span class="c"># 3. Slicing Avanc√© (Boolean Masking)</span>
<span class="var">arr</span> = <span class="var">np</span>.<span class="fn">arange</span>(<span class="num">12</span>).<span class="fn">reshape</span>(<span class="num">3</span>, <span class="num">4</span>)
<span class="var">mask</span> = (<span class="var">arr</span> > <span class="num">5</span>) & (<span class="var">arr</span> < <span class="num">10</span>)
<span class="var">filtered</span> = <span class="var">arr</span>[<span class="var">mask</span>]  <span class="c"># Filtre imm√©diat sans boucle</span></pre>
                </div>

                <div class="code">
                    <div class="code-head"><span class="dot g"></span>Op√©rations Matricielles</div>
                    <pre><span class="var">A</span> = <span class="var">np</span>.<span class="fn">array</span>([[<span class="num">1</span>, <span class="num">2</span>], [<span class="num">3</span>, <span class="num">4</span>]])
<span class="var">B</span> = <span class="var">np</span>.<span class="fn">array</span>([[<span class="num">0</span>, <span class="num">1</span>], [<span class="num">1</span>, <span class="num">0</span>]])

<span class="c"># Produit Matriciel (Dot Product)</span>
<span class="var">dot</span> = <span class="var">A</span> @ <span class="var">B</span>      <span class="c"># [[2 1], [4 3]]</span>

<span class="c"># Transposition</span>
<span class="var">trans</span> = <span class="var">A</span>.<span class="prop">T</span>      <span class="c"># [[1 3], [2 4]]</span>

<span class="c"># Statistique sur axe</span>
<span class="c"># axis=0 (colonne), axis=1 (ligne)</span>
<span class="var">avg_cols</span> = <span class="var">A</span>.<span class="fn">mean</span>(axis=<span class="num">0</span>)</pre>
                </div>
            </div>
        </div>
    </section>

    <!-- S2: ACQUISITION (NEW) -->
    <section id="s2">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">02</div>
                <div>
                    <h2 class="sec-title">Acquisition de Donn√©es</h2>
                    <p class="sec-sub">SQL, APIs, Fichiers</p>
                </div>
            </div>

            <details>
                <summary>üìñ Se connecter au monde r√©el</summary>
                <div>
                    <p>En entreprise, la donn√©e n'arrive pas magiquement en CSV propre.</p>
                    <p>Il faut aller la chercher : dans des bases de donn√©es relationnelles (SQL), via des APIs REST
                        (JSON), ou dans des formats Big Data (Parquet).</p>
                    <p><strong>Pandas</strong> travaille main dans la main avec <strong>SQLAlchemy</strong> pour
                        lire/√©crire en base de donn√©es.</p>
                </div>
            </details>

            <div class="grid2">
                <div class="code">
                    <div class="code-head"><span class="dot y"></span>SQL & Bases de Donn√©es</div>
                    <pre><span class="kw">from</span> sqlalchemy <span class="kw">import</span> create_engine
<span class="kw">import</span> pandas <span class="kw">as</span> pd

<span class="c"># Connexion (URL: dialect://user:pass@host/db)</span>
<span class="var">engine</span> = <span class="fn">create_engine</span>(<span class="str">"sqlite:///data.db"</span>)

<span class="c"># Lire une table ou requ√™te SQL</span>
<span class="var">df</span> = <span class="var">pd</span>.<span class="fn">read_sql</span>(<span class="str">"SELECT * FROM users WHERE age > 18"</span>, <span class="var">engine</span>)

<span class="c"># √âcrire le DataFrame en table</span>
<span class="var">df</span>.<span class="fn">to_sql</span>(<span class="str">"adults"</span>, <span class="var">engine</span>, if_exists=<span class="str">"replace"</span>)</pre>
                </div>

                <div class="code">
                    <div class="code-head"><span class="dot y"></span>APIs & Formats</div>
                    <pre><span class="kw">import</span> requests

<span class="c"># Consommer une API REST</span>
<span class="var">res</span> = <span class="var">requests</span>.<span class="fn">get</span>(<span class="str">"https://api.coincap.io/v2/assets"</span>)
<span class="var">data</span> = <span class="var">res</span>.<span class="fn">json</span>()[<span class="str">'data'</span>]  <span class="c"># Liste de dicts</span>

<span class="c"># Convertir JSON -> Pandas</span>
<span class="var">df_crypto</span> = <span class="var">pd</span>.<span class="cls">DataFrame</span>(<span class="var">data</span>)

<span class="c"># Formats de fichiers</span>
<span class="var">df</span>.<span class="fn">to_csv</span>(<span class="str">"data.csv"</span>, index=<span class="kw">False</span>)     <span class="c"># Standard</span>
<span class="var">df</span>.<span class="fn">to_parquet</span>(<span class="str">"data.parquet"</span>)          <span class="c"># Rapide & Compact (Pro)</span>
<span class="var">df</span>.<span class="fn">to_excel</span>(<span class="str">"report.xlsx"</span>)             <span class="c"># Pour le business</span></pre>
                </div>
            </div>
        </div>
    </section>

    <!-- S3: PANDAS -->
    <section id="s3">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">03</div>
                <div>
                    <h2 class="sec-title">Pandas : L'Analyse</h2>
                    <p class="sec-sub">DataFrames, S√©ries & Manipulation</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre Pandas (Expert)</summary>
                <div>
                    <p>Au-del√† du chargement CSV, Pandas g√®re les <strong>Time Series</strong> (dates), les jointures
                        SQL-style (merge) et les agr√©gations complexes.</p>
                    <p>Le nettoyage de donn√©es (Data Cleaning) repr√©sente 80% du travail d'un Data Scientist.</p>
                </div>
            </details>

            <div class="grid2">
                <div class="code">
                    <div class="code-head"><span class="dot y"></span>Manipulation Temporelle</div>
                    <pre><span class="kw">import</span> pandas <span class="kw">as</span> pd

<span class="c"># Cr√©ation index temporel</span>
<span class="var">df</span>[<span class="str">'Date'</span>] = <span class="var">pd</span>.<span class="fn">to_datetime</span>(<span class="var">df</span>[<span class="str">'Date'</span>])
<span class="var">df</span>.<span class="fn">set_index</span>(<span class="str">'Date'</span>, inplace=<span class="kw">True</span>)

<span class="c"># Resampling (Agr√©gation par P√©riode)</span>
<span class="c"># Moyenne mensuelle 'M', Hebdo 'W'</span>
<span class="var">monthly</span> = <span class="var">df</span>.<span class="fn">resample</span>(<span class="str">'M'</span>).<span class="fn">mean</span>()

<span class="c"># Glissement (Rolling)</span>
<span class="c"># Moyenne mobile sur 7 jours</span>
<span class="var">roll</span> = <span class="var">df</span>[<span class="str">'Prix'</span>].<span class="fn">rolling</span>(<span class="num">7</span>).<span class="fn">mean</span>()</pre>
                </div>

                <div class="code">
                    <div class="code-head"><span class="dot y"></span>Pivot Tables & Optimisation</div>
                    <pre><span class="c"># Optimisation String -> Category (Gain RAM x10)</span>
<span class="var">df</span>[<span class="str">'Ville'</span>] = <span class="var">df</span>[<span class="str">'Ville'</span>].<span class="fn">astype</span>(<span class="str">'category'</span>)

<span class="c"># Manipulation de Textes Vectoris√©e</span>
<span class="c"># .str accessor est beaucoup plus rapide que apply()</span>
<span class="var">df</span>[<span class="str">'Nom_Maj'</span>] = <span class="var">df</span>[<span class="str">'Nom'</span>].<span class="prop">str</span>.<span class="fn">upper</span>().<span class="prop">str</span>.<span class="fn">strip</span>()

<span class="c"># Pivot Table (Style Excel Crois√© Dynamique)</span>
<span class="var">pivot</span> = <span class="var">df</span>.<span class="fn">pivot_table</span>(
    values=<span class="str">'Ventes'</span>, 
    index=<span class="str">'Region'</span>, 
    columns=<span class="str">'Annee'</span>, 
    aggfunc=<span class="str">'sum'</span>
)

<span class="c"># Merge Avanc√© (Proche du SQL)</span>
<span class="var">full_data</span> = <span class="var">pd</span>.<span class="fn">merge</span>(
    <span class="var">commandes</span>, <span class="var">clients</span>, 
    on=<span class="str">'client_id'</span>, 
    how=<span class="str">'inner'</span>, 
    validate=<span class="str">'m:1'</span>  <span class="c"># V√©rifie int√©grit√© des donn√©es</span>
)</pre>
                </div>
            </div>
        </div>
    </section>

    <!-- S4: VIZ -->
    <section id="s4">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">04</div>
                <div>
                    <h2 class="sec-title">Visualisation de Donn√©es</h2>
                    <p class="sec-sub">Matplotlib & Seaborn</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre la Dataviz (OO API)</summary>
                <div>
                    <p>Pour des graphiques simples, `plt.plot()` suffit. Pour du professionnel, utilisez l'API Orient√©e
                        Objet : `fig, ax = plt.subplots()`.</p>
                    <p>Cela permet de g√©rer plusieurs graphiques (subplots) et de contr√¥ler chaque axe ind√©pendamment.
                    </p>
                </div>
            </details>

            <div class="grid2">
                <div>
                    <div class="code">
                        <div class="code-head"><span class="dot r"></span>Viz Professionnelle</div>
                        <pre><span class="kw">import</span> matplotlib.pyplot <span class="kw">as</span> plt
<span class="kw">import</span> seaborn <span class="kw">as</span> sns

<span class="c"># Style Global</span>
<span class="var">sns</span>.<span class="fn">set_theme</span>(style=<span class="str">"darkgrid"</span>)

<span class="c"># Cr√©ation Figure et Axes (2 graphiques)</span>
<span class="var">fig</span>, (<span class="var">ax1</span>, <span class="var">ax2</span>) = <span class="var">plt</span>.<span class="fn">subplots</span>(<span class="num">1</span>, <span class="num">2</span>, figsize=(<span class="num">12</span>, <span class="num">5</span>))

<span class="c"># Graph 1 : Distribution (Violin)</span>
<span class="var">sns</span>.<span class="fn">violinplot</span>(data=<span class="var">df</span>, x=<span class="str">"Class"</span>, y=<span class="str">"Age"</span>, ax=<span class="var">ax1</span>)
<span class="var">ax1</span>.<span class="fn">set_title</span>(<span class="str">"Distribution Age par Classe"</span>)

<span class="c"># Graph 2 : Relation (Scatter)</span>
<span class="var">sns</span>.<span class="fn">scatterplot</span>(data=<span class="var">df</span>, x=<span class="str">"Prix"</span>, y=<span class="str">"Age"</span>, hue=<span class="str">"Survie"</span>, ax=<span class="var">ax2</span>)
<span class="var">ax2</span>.<span class="fn">set_title</span>(<span class="str">"Prix vs Age"</span>)

<span class="var">plt</span>.<span class="fn">tight_layout</span>()
<span class="var">plt</span>.<span class="fn">show</span>()</pre>
                    </div>
                </div>
                <div>
                    <div class="viz-container">
                        <div class="viz-placeholder" data-type="scatter"></div>
                        <p style="margin-top:10px; font-size:0.8rem">Scatter Plot Avanc√©</p>
                    </div>
                    <div class="viz-container">
                        <div class="viz-placeholder" data-type="heatmap"></div>
                        <p style="margin-top:10px; font-size:0.8rem">Heatmap Corr√©lation</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- S5: MACHINE LEARNING -->
    <section id="s5">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">05</div>
                <div>
                    <h2 class="sec-title">Machine Learning</h2>
                    <p class="sec-sub">Scikit-Learn (Sklearn)</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre le Workflow ML (Preprocessing & Pipelines)</summary>
                <div>
                    <p>Un mod√®le ne comprend que les chiffres. Il faut <strong>Encoder</strong> le texte (H/F -> 0/1) et
                        <strong>Scaler</strong> les donn√©es num√©riques (mettre √† la m√™me √©chelle).
                    </p>
                    <p>Les <strong>Pipelines</strong> encapsulent ces √©tapes pour √©viter la fuite de donn√©es (Data
                        Leakage) et simplifier le d√©ploiement.</p>
                    <p>Pour optimiser, on utilise <strong>GridSearchCV</strong> qui teste toutes les combinaisons
                        d'hyperparam√®tres.</p>
                </div>
            </details>

            <details>
                <summary>üìñ Concepts Cl√©s (Overfitting, Biais/Variance)</summary>
                <div>
                    <p><strong>Overfitting (Surapprentissage)</strong> : Le mod√®le apprend "par coeur" le train set mais
                        √©choue sur le test set (High Variance). Solution : Plus de donn√©es, simplifier le mod√®le,
                        r√©gularisation.</p>
                    <p><strong>Cross-Validation</strong> : D√©couper les donn√©es en K parties (Folds) pour entrainer K
                        fois le mod√®le et avoir un score robuste.</p>
                </div>
            </details>

            <!-- Tableau des M√©triques -->
            <table>
                <tr>
                    <th>M√©trique</th>
                    <th>Cas d'usage</th>
                    <th>Formule Intuitive</th>
                </tr>
                <tr>
                    <td><strong>Accuracy</strong></td>
                    <td>Classes √©quilibr√©es</td>
                    <td>(Vrai Pos + Vrai Neg) / Total</td>
                </tr>
                <tr>
                    <td><strong>Recall (Rappel)</strong></td>
                    <td>D√©tection fraude/maladie (Ne rien rater)</td>
                    <td>Vrai Pos / (Vrai Pos + Faux Neg)</td>
                </tr>
                <tr>
                    <td><strong>Precision</strong></td>
                    <td>Anti-Spam (Ne pas filtrer les bons emails)</td>
                    <td>Vrai Pos / (Vrai Pos + Faux Pos)</td>
                </tr>
                <tr>
                    <td><strong>F1-Score</strong></td>
                    <td>Compromis Pr√©cision/Rappel (G√©n√©raliste)</td>
                    <td>Moyenne harmonique</td>
                </tr>
            </table>

            <div class="code">
                <div class="code-head"><span class="dot y"></span>Validation Robuste (Cross-Validation)</div>
                <pre><span class="kw">from</span> sklearn.model_selection <span class="kw">import</span> cross_val_score, KFold

<span class="c"># Preprocessing Pipeline (D√©j√† vu : Scaler + OneHot)</span>
<span class="var">model_pipe</span> = <span class="var">...</span> 

<span class="c"># Strat√©gie de d√©coupage (5 Folds, m√©lange pr√©alable)</span>
<span class="var">cv</span> = <span class="cls">KFold</span>(n_splits=<span class="num">5</span>, shuffle=<span class="kw">True</span>, random_state=<span class="num">42</span>)

<span class="c"># √âvaluation sur 5 rounds</span>
<span class="var">scores</span> = <span class="fn">cross_val_score</span>(<span class="var">model_pipe</span>, <span class="var">X</span>, <span class="var">y</span>, cv=<span class="var">cv</span>, scoring=<span class="str">'f1'</span>)

<span class="fn">print</span>(<span class="str">f"Score Moyen : </span>{<span class="var">scores</span>.<span class="fn">mean</span>():.3f}<span class="str"> (+/- </span>{<span class="var">scores</span>.<span class="fn">std</span>()}<span class="str">)"</span>)</pre>
            </div>

            <div class="code">
                <div class="code-head"><span class="dot y"></span>Pipeline Complet : Nettoyage ‚Üí Scaling ‚Üí Mod√®le</div>
                <pre><span class="kw">from</span> sklearn.pipeline <span class="kw">import</span> Pipeline
<span class="kw">from</span> sklearn.preprocessing <span class="kw">import</span> StandardScaler, OneHotEncoder
<span class="kw">from</span> sklearn.compose <span class="kw">import</span> ColumnTransformer
<span class="kw">from</span> sklearn.ensemble <span class="kw">import</span> RandomForestClassifier
<span class="kw">from</span> sklearn.model_selection <span class="kw">import</span> GridSearchCV

<span class="c"># 1. Preprocessing Colonnes</span>
<span class="var">numeric_transformer</span> = <span class="cls">Pipeline</span>(steps=[(<span class="str">'scaler'</span>, <span class="cls">StandardScaler</span>())])
<span class="var">categorical_transformer</span> = <span class="cls">Pipeline</span>(steps=[(<span class="str">'onehot'</span>, <span class="cls">OneHotEncoder</span>())])

<span class="var">preprocessor</span> = <span class="cls">ColumnTransformer</span>(
    transformers=[
        (<span class="str">'num'</span>, <span class="var">numeric_transformer</span>, [<span class="str">'age'</span>, <span class="str">'fare'</span>]),
        (<span class="str">'cat'</span>, <span class="var">categorical_transformer</span>, [<span class="str">'embarked'</span>, <span class="str">'sex'</span>])
    ])

<span class="c"># 2. Pipeline Global</span>
<span class="var">pipe</span> = <span class="cls">Pipeline</span>(steps=[
    (<span class="str">'preprocessor'</span>, <span class="var">preprocessor</span>),
    (<span class="str">'classifier'</span>, <span class="cls">RandomForestClassifier</span>())
])

<span class="c"># 3. Grid Search (Optimisation)</span>
<span class="var">param_grid</span> = {
    <span class="str">'classifier__n_estimators'</span>: [<span class="num">50</span>, <span class="num">100</span>],
    <span class="str">'classifier__max_depth'</span>: [<span class="kw">None</span>, <span class="num">10</span>, <span class="num">20</span>]
}

<span class="var">grid</span> = <span class="cls">GridSearchCV</span>(<span class="var">pipe</span>, <span class="var">param_grid</span>, cv=<span class="num">5</span>)
<span class="var">grid</span>.<span class="fn">fit</span>(<span class="var">X_train</span>, <span class="var">y_train</span>)

<span class="fn">print</span>(<span class="str">"Best score:"</span>, <span class="var">grid</span>.<span class="prop">best_score_</span>)</pre>
            </div>
        </div>
    </section>

    <!-- S6: DEEP LEARNING -->
    <section id="s6">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">06</div>
                <div>
                    <h2 class="sec-title">Deep Learning</h2>
                    <p class="sec-sub">R√©seaux de Neurones & Keras</p>
                </div>
            </div>

            <details>
                <summary>üìñ Comprendre le Deep Learning</summary>
                <div>
                    <p>Neurone artificiel = <strong>Somme pond√©r√©e</strong> des entr√©es + Biais -> <strong>Fonction
                            d'activation</strong> (Non-lin√©arit√©).</p>
                    <p>L'apprentissage consiste √† ajuster ces poids (Backpropagation) pour minimiser une fonction de
                        co√ªt (Loss).</p>
                </div>
            </details>

            <h4 style="margin-top:20px">Cheat Sheet Architecture DL</h4>
            <table>
                <tr>
                    <th>Type Probl√®me</th>
                    <th>Derni√®re Couche (Activation)</th>
                    <th>Loss Function (Erreur)</th>
                </tr>
                <tr>
                    <td><strong>R√©gression</strong> (Prix)</td>
                    <td><code>Linear</code> (Pas d'activ)</td>
                    <td><code>MSE</code> (Mean Squared Error)</td>
                </tr>
                <tr>
                    <td><strong>Binaires</strong> (Oui/Non)</td>
                    <td><code>Sigmoid</code> (Proba 0-1)</td>
                    <td><code>Binary Crossentropy</code></td>
                </tr>
                <tr>
                    <td><strong>Multiclasse</strong> (Chien/Chat/Oiseau)</td>
                    <td><code>Softmax</code> (Somme probas = 1)</td>
                    <td><code>Categorical Crossentropy</code></td>
                </tr>
            </table>

            <div class="grid2">
                <div class="code">
                    <div class="code-head"><span class="dot r"></span>Classification Image (Keras)</div>
                    <pre><span class="kw">import</span> tensorflow <span class="kw">as</span> tf
<span class="kw">from</span> tensorflow <span class="kw">import</span> keras
<span class="kw">from</span> tensorflow.keras <span class="kw">import</span> layers

<span class="c"># Mod√®le S√©quentiel</span>
<span class="var">model</span> = <span class="var">keras</span>.<span class="cls">Sequential</span>([
    <span class="c"># Input: Image 28x28 (Flatten -> Vecteur 784)</span>
    <span class="var">layers</span>.<span class="cls">Flatten</span>(input_shape=(<span class="num">28</span>, <span class="num">28</span>)),
    
    <span class="c"># Hidden Layer 1 (Dense = Fully Connected)</span>
    <span class="var">layers</span>.<span class="cls">Dense</span>(<span class="num">128</span>, activation=<span class="str">'relu'</span>),
    <span class="var">layers</span>.<span class="cls">Dropout</span>(<span class="num">0.2</span>),  <span class="c"># Evite overfitting</span>
    
    <span class="c"># Output Layer (10 classes probabilit√©s)</span>
    <span class="var">layers</span>.<span class="cls">Dense</span>(<span class="num">10</span>, activation=<span class="str">'softmax'</span>)
])

<span class="c"># Compilation</span>
<span class="var">model</span>.<span class="fn">compile</span>(
    optimizer=<span class="str">'adam'</span>,
    loss=<span class="str">'sparse_categorical_crossentropy'</span>,
    metrics=[<span class="str">'accuracy'</span>]
)

<span class="c"># Entrainement</span>
<span class="var">model</span>.<span class="fn">fit</span>(<span class="var">x_train</span>, <span class="var">y_train</span>, epochs=<span class="num">5</span>)</pre>
                </div>
                <div>
                    <div class="tip"><strong>Epoch</strong> : Un passage complet de toutes les donn√©es dans le r√©seau.
                    </div>
                    <div class="tip" style="margin-top:20px"><strong>Loss</strong> : L'erreur que le r√©seau essaie de
                        minimiser (ex: MSE pour r√©gression).</div>
                    <div class="tip" style="margin-top:20px"><strong>Optimizer</strong> : L'algorithme qui met √† jour
                        les poids pour r√©duire la Loss (Adam est le standard).</div>
                </div>
            </div>
        </div>
    </section>

    <!-- S7: MISE EN PRODUCTION (NEW) -->
    <section id="s7">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">07</div>
                <div>
                    <h2 class="sec-title">Mise en Production</h2>
                    <p class="sec-sub">MLOps, Persistance, Streamlit</p>
                </div>
            </div>

            <details>
                <summary>üìñ Sortir du Notebook</summary>
                <div>
                    <p>Un mod√®le qui reste dans un Notebook n'a aucune valeur. Il faut l'exporter (Serialisation) pour
                        pouvoir l'utiliser dans une application web ou une API.</p>
                    <p><strong>Streamlit</strong> est l'outil parfait pour cr√©er des d√©mos web interactives en pur
                        Python, sans toucher au HTML/CSS.</p>
                </div>
            </details>

            <div class="grid2">
                <div class="code">
                    <div class="code-head"><span class="dot g"></span>Sauvegarder un Mod√®le</div>
                    <pre><span class="kw">import</span> joblib

<span class="c"># 1. Sauvegarder (Serialisation)</span>
<span class="var">joblib</span>.<span class="fn">dump</span>(<span class="var">model</span>, <span class="str">'mon_modele.pkl'</span>)

<span class="c"># ... dans un autre script ...</span>

<span class="c"># 2. Charger (Deserialisation)</span>
<span class="var">loaded_model</span> = <span class="var">joblib</span>.<span class="fn">load</span>(<span class="str">'mon_modele.pkl'</span>)

<span class="c"># 3. Pr√©diction</span>
<span class="var">prediction</span> = <span class="var">loaded_model</span>.<span class="fn">predict</span>(<span class="var">new_data</span>)</pre>
                </div>

                <div class="code">
                    <div class="code-head"><span class="dot g"></span>App Streamlit (app.py)</div>
                    <pre><span class="kw">import</span> streamlit <span class="kw">as</span> st
<span class="kw">import</span> pandas <span class="kw">as</span> pd

<span class="var">st</span>.<span class="fn">title</span>(<span class="str">"D√©mo IA Prix Immo"</span>)

<span class="c"># Widgets Interactifs</span>
<span class="var">surface</span> = <span class="var">st</span>.<span class="fn">slider</span>(<span class="str">"Surface (m2)"</span>, <span class="num">10</span>, <span class="num">200</span>, <span class="num">50</span>)
<span class="var">quartier</span> = <span class="var">st</span>.<span class="fn">selectbox</span>(<span class="str">"Quartier"</span>, [<span class="str">"Centre"</span>, <span class="str">"Sud"</span>])

<span class="kw">if</span> <span class="var">st</span>.<span class="fn">button</span>(<span class="str">"Estimer"</span>):
    <span class="c"># Appel du mod√®le...</span>
    <span class="var">prix</span> = <span class="num">250000</span>  <span class="c"># fake</span>
    <span class="var">st</span>.<span class="fn">success</span>(<span class="str">f"Prix estim√© : </span>{<span class="var">prix</span>}<span class="str"> ‚Ç¨"</span>)</pre>
                </div>
            </div>
        </div>
    </section>

    <!-- S8: R√âF√âRENCE -->
    <section id="s8">
        <div class="container">
            <div class="sec-header">
                <div class="sec-num">08</div>
                <div>
                    <h2 class="sec-title">R√©f√©rence Rapide</h2>
                    <p class="sec-sub">Cheat Sheet des commandes vitales</p>
                </div>
            </div>

            <table>
                <tr>
                    <th>Librairie</th>
                    <th>Code commun</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><strong>Pandas</strong></td>
                    <td><code>pd.read_csv('file.csv')</code></td>
                    <td>Lire un fichier de donn√©es</td>
                </tr>
                <tr>
                    <td></td>
                    <td><code>df.groupby('col').mean()</code></td>
                    <td>Agr√©gation style tableau crois√©</td>
                </tr>
                <tr>
                    <td></td>
                    <td><code>df.plot()</code></td>
                    <td>Plot rapide int√©gr√©</td>
                </tr>
                <tr>
                    <td><strong>Numpy</strong></td>
                    <td><code>np.array([1, 2, 3])</code></td>
                    <td>Cr√©er un vecteur</td>
                </tr>
                <tr>
                    <td></td>
                    <td><code>np.random.normal()</code></td>
                    <td>G√©n√©rer donn√©es al√©atoires (Gauss)</td>
                </tr>
                <tr>
                    <td><strong>Sklearn</strong></td>
                    <td><code>model.fit(X, y)</code></td>
                    <td>Entra√Æner le mod√®le</td>
                </tr>
                <tr>
                    <td></td>
                    <td><code>model.predict(X)</code></td>
                    <td>Faire des pr√©dictions</td>
                </tr>
                <tr>
                    <td><strong>SQL/Joblib</strong></td>
                    <td><code>pd.read_sql(q, engine)</code></td>
                    <td>Lire depuis une DB</td>
                </tr>
                <tr>
                    <td></td>
                    <td><code>joblib.dump(model, 'f.pkl')</code></td>
                    <td>Sauvegarder le mod√®le</td>
                </tr>
            </table>

            <h4 style="margin-top:30px">Deep Learning (Pour aller plus loin)</h4>
            <div class="grid2">
                <div class="code" style="border:1px solid #ea580c">
                    <div class="code-head" style="color:#f97316">TensorFlow / Keras</div>
                    <pre><span class="c"># Standard Google (Prod)</span>
<span class="var">model</span> = <span class="var">keras</span>.<span class="cls">Sequential</span>([
    <span class="var">layers</span>.<span class="cls">Dense</span>(<span class="num">64</span>, activation=<span class="str">'relu'</span>),
    <span class="var">layers</span>.<span class="cls">Dense</span>(<span class="num">10</span>)
])</pre>
                </div>
                <div class="code" style="border:1px solid #ef4444">
                    <div class="code-head" style="color:#ef4444">PyTorch</div>
                    <pre><span class="c"># Standard Recherche (Meta)</span>
<span class="kw">class</span> <span class="cls">Net</span>(<span class="var">nn</span>.<span class="cls">Module</span>):
    <span class="kw">def</span> <span class="fn">__init__</span>(<span class="var">self</span>):
        <span class="var">super</span>().<span class="fn">__init__</span>()
        <span class="var">self</span>.<span class="var">fc1</span> = <span class="var">nn</span>.<span class="cls">Linear</span>(<span class="num">10</span>, <span class="num">64</span>)</pre>
                </div>
            </div>

        </div>
    </section>

    <!-- SECTION QUIZ -->
    <section id="quiz-section" class="quiz-container">
        <div class="container">
            <h2>Testez vos connaissances</h2>
            <div id="quiz-app"></div>
        </div>
    </section>

    <script type="module">
        import '../../assets/js/quiz-engine.js';
        document.addEventListener('DOMContentLoaded', () => {
            new window.QuizEngine({ containerId: 'quiz-app', jsonPath: 'quiz_data.json', questionsPerSession: 10 });
        });
    </script>
    <script src="../../assets/js/quiz-engine.js"></script>
    <script>
        window.addEventListener('load', () => {
            if (window.QuizEngine && !document.querySelector('.quiz-intro')) {
                new window.QuizEngine({ containerId: 'quiz-app', jsonPath: 'quiz_data.json', questionsPerSession: 10 });
            }
        });
    </script>

    <footer>
        <div class="container">
            <p style="margin-bottom:8px"><strong>M√©mo Python Data Science</strong> ‚Ä¢ Numpy / Pandas / Sklearn</p>
            <p style="font-size:.8rem">Cr√©√© par <strong>Geoffroy Streit</strong>, assist√© par IA ‚Äî Guide pour l'analyse
                et l'IA.</p>
        </div>
    </footer>

    <script src="script.js"></script>
</body>

</html>