<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Hooks - M√©mo React.js</title>
    <meta name="description" content="Cr√©er des Custom Hooks en React pour r√©utiliser la logique d'√©tat.">
    <link
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../assets/css/quiz-style.css">
    <link rel="stylesheet" href="../style.css">
    <script src="../js/nav.js" defer></script>
    <script src="../script.js" defer></script>
</head>

<body>
    <header></header>
    <div class="main-layout">
        <aside id="sidebar-container"></aside>
        <main>
            <section id="s10" class="module-content">
                <div class="container">
                    <div class="sec-header">
                        <div class="sec-num">10</div>
                        <div>
                            <h2 class="sec-title">Custom Hooks</h2>
                            <p class="sec-sub">R√©utiliser la logique</p>
                        </div>
                    </div>

                    <details>
                        <summary>üí° Pourquoi cr√©er des Custom Hooks ?</summary>
                        <div class="details-content">
                            <p>Les Custom Hooks permettent d'extraire de la <strong>logique d'√©tat</strong> (pas de
                                l'UI) pour
                                la r√©utiliser.</p>
                            <p>Par exemple, si plusieurs composants doivent savoir si l'utilisateur est en ligne ou hors
                                ligne,
                                au lieu de copier-coller les <code>useState</code> et <code>useEffect</code> d'√©couteur
                                d'√©v√©nement, vous cr√©ez un hook <code>useOnlineStatus</code> simple √† utiliser.</p>
                        </div>
                    </details>

                    <div class="code">
                        <div class="code-head"><span class="dot r"></span><span class="dot y"></span><span
                                class="dot g"></span>useFetch (Exemple)</div>
                        <pre><span class="c">// Extraction de la logique</span>
<span class="kw">function</span> <span class="fn">useFetch</span>(<span class="var">url</span>) {
    <span class="kw">const</span> [<span class="var">data</span>, <span class="fn">setData</span>] = <span class="fn">useState</span>(<span class="kw">null</span>);

    <span class="fn">useEffect</span>(() => {
        <span class="fn">fetch</span>(<span class="var">url</span>)
            .<span class="fn">then</span>(<span class="var">res</span> => <span class="var">res</span>.<span class="fn">json</span>())
            .<span class="fn">then</span>(<span class="var">d</span> => <span class="fn">setData</span>(<span class="var">d</span>));
    }, [<span class="var">url</span>]);

    <span class="kw">return</span> <span class="var">data</span>;
}

<span class="c">// Utilisation</span>
<span class="kw">function</span> <span class="fn">App</span>() {
    <span class="kw">const</span> <span class="var">user</span> = <span class="fn">useFetch</span>(<span class="str">"/api/user"</span>);
    <span class="kw">return</span> <span class="var">user</span> && <span class="tag">&lt;div&gt;</span>{<span class="var">user</span>.<span class="prop">name</span>}<span class="tag">&lt;/div&gt;</span>;
}</pre>
                    </div>

                    <div class="grid2">
                        <div class="code">
                            <div class="code-head"><span class="dot r"></span><span class="dot y"></span><span
                                    class="dot g"></span>useLocalStorage</div>
                            <pre><span class="kw">function</span> <span class="fn">useLocalStorage</span>(<span class="var">key</span>, <span class="var">initial</span>) {
    <span class="kw">const</span> [<span class="var">stored</span>, <span class="fn">setStored</span>] = <span class="fn">useState</span>(() => {
        <span class="kw">return</span> <span class="fn">localStorage</span>.<span class="fn">getItem</span>(<span class="var">key</span>) || <span class="var">initial</span>;
    });

    <span class="fn">useEffect</span>(() => {
        <span class="fn">localStorage</span>.<span class="fn">setItem</span>(<span class="var">key</span>, <span class="var">stored</span>);
    }, [<span class="var">key</span>, <span class="var">stored</span>]);

    <span class="kw">return</span> [<span class="var">stored</span>, <span class="fn">setStored</span>];
}</pre>
                        </div>
                        <div class="code">
                            <div class="code-head"><span class="dot r"></span><span class="dot y"></span><span
                                    class="dot g"></span>useWindowSize</div>
                            <pre><span class="kw">function</span> <span class="fn">useWindowSize</span>() {
    <span class="kw">const</span> [<span class="var">size</span>, <span class="fn">setSize</span>] = <span class="fn">useState</span>(<span class="fn">window</span>.<span class="prop">innerWidth</span>);
    
    <span class="fn">useEffect</span>(() => {
        <span class="kw">const</span> <span class="fn">handle</span> = () => <span class="fn">setSize</span>(<span class="fn">window</span>.<span class="prop">innerWidth</span>);
        <span class="fn">window</span>.<span class="fn">addEventListener</span>(<span class="str">"resize"</span>, <span class="fn">handle</span>);
        <span class="kw">return</span> () => <span class="fn">window</span>.<span class="fn">removeEventListener</span>(...)
    }, []);
    
    <span class="kw">return</span> <span class="var">size</span>;
}</pre>
                        </div>
                    </div>

                    <div class="tip">
                        <strong>R√®gle d'or</strong> : Un Custom Hook doit toujours commencer par "use" pour que React
                        puisse v√©rifier les r√®gles des hooks (linting).
                    </div>


                    <div class="grid2" style="margin-top:20px;">
                        <div class="ref-card" style="background:var(--bg2); border-left:4px solid var(--purple);">
                            <h4>üß± Analogie : Les Briques LEGO</h4>
                            <p style="font-size:0.9rem; margin-top:10px;">
                                Les Hooks sont des briques √©l√©mentaires.
                                <br>
                                Un <strong>Custom Hook</strong>, c'est quand vous assemblez 2-3 briques pour cr√©er une
                                "Porte" ou une "Roue". Ensuite, vous pouvez utiliser cette "Roue" partout sur votre
                                voiture sans avoir √† r√©-assembler le pneu et la jante √† chaque fois.
                            </p>
                        </div>
                        <div class="code">
                            <div class="code-head"><span class="dot r"></span><span class="dot y"></span><span
                                    class="dot g"></span>Composition de Hooks</div>
                            <pre style="font-size:0.8rem; line-height:1.4"><span class="c">// On peut utiliser un Custom Hook DANS un autre !</span>
<span class="kw">function</span> <span class="fn">useDeviceType</span>() {
    <span class="c">// On r√©utilise useWindowSize qu'on a cr√©√© avant</span>
    <span class="kw">const</span> <span class="var">width</span> = <span class="fn">useWindowSize</span>();
    
    <span class="kw">if</span> (<span class="var">width</span> < <span class="num">768</span>) <span class="kw">return</span> <span class="str">"mobile"</span>;
    <span class="kw">return</span> <span class="str">"desktop"</span>;
}</pre>
                        </div>
                    </div>

                    <div class="code">
                        <div class="code-head"><span class="dot r"></span><span class="dot y"></span><span
                                class="dot g"></span>Advanced : Testing Concept</div>
                        <pre><span class="c">// Comment tester un Hook sans composant ?</span>
<span class="c">// Utilisez "renderHook" de React Testing Library</span>

<span class="kw">import</span> { <span class="fn">renderHook</span>, <span class="fn">act</span> } <span class="kw">from</span> <span class="str">'@testing-library/react'</span>;

<span class="fn">test</span>(<span class="str">'should increment'</span>, () => {
    <span class="kw">const</span> { <span class="var">result</span> } = <span class="fn">renderHook</span>(() => <span class="fn">useCounter</span>());
    
    <span class="fn">act</span>(() => {
        <span class="var">result</span>.<span class="prop">current</span>.<span class="fn">increment</span>();
    });
    
    <span class="fn">expect</span>(<span class="var">result</span>.<span class="prop">current</span>.<span class="prop">count</span>).<span class="fn">toBe</span>(<span class="num">1</span>);
});</pre>
                    </div>

                    <div class="nav-buttons">
                        <a href="09_hooks_rules.html" class="btn-prev">‚Üê Hooks Rules</a>
                        <a href="11_context.html" class="btn-next">Suivant : Context API ‚Üí</a>
                    </div>
                </div>
            </section>
        </main>
    </div>
</body>

</html>